<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Select User</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Select your user profile for the Medication Tracker app." />
  
  <!-- PWA Meta Tags -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#26a69a" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="MedTracker" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="application-name" content="MedTracker" />
  
  <!-- Icons -->
  <link rel="icon" href="icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="icon-192.png" />
  <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />
  <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
  
  <!-- Stylesheets -->
  <!-- Stylesheets -->
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    body {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      font-family: var(--font-family);
    }
    
    .user-selection-card {
      background: var(--surface-elevated);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-xl);
      padding: var(--spacing-2xl);
      width: 100%;
      max-width: 420px;
      margin: var(--spacing-lg);
      border: 1px solid var(--border-color);
    }
    
    .user-selection-header {
      text-align: center;
      margin-bottom: var(--spacing-xl);
    }
    
    .user-selection-header h1 {
      color: var(--primary-color);
      font-size: var(--font-size-2xl);
      font-weight: 700;
      margin-bottom: var(--spacing-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-md);
    }
    
    .user-selection-header p {
      color: var(--text-secondary);
      font-size: var(--font-size-base);
      margin: 0;
    }
    
    .user-list {
      margin-bottom: var(--spacing-xl);
      display: flex;
      flex-direction: column;
      gap: var(--spacing-md);
    }
    
    .user-item {
      display: flex;
      align-items: center;
      background: var(--surface);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      overflow: hidden;
      transition: all var(--transition-fast);
    }
    
    .user-item:hover {
      box-shadow: var(--shadow-md);
      border-color: var(--border-hover);
    }
    
    .user-btn {
      flex: 1;
      padding: var(--spacing-lg);
      background: transparent;
      border: none;
      color: var(--text-primary);
      font-size: var(--font-size-lg);
      font-weight: 600;
      cursor: pointer;
      text-align: left;
      transition: all var(--transition-fast);
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      min-height: 60px;
    }
    
    .user-btn:hover {
      background: rgba(37, 99, 235, 0.05);
      color: var(--primary-color);
    }
    
    .user-btn i {
      color: var(--primary-color);
      font-size: var(--font-size-xl);
    }
    
    .delete-btn {
      padding: var(--spacing-lg);
      background: transparent;
      border: none;
      color: var(--error-color);
      font-size: var(--font-size-xl);
      cursor: pointer;
      transition: all var(--transition-fast);
      min-height: 60px;
      min-width: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .delete-btn:hover {
      background: rgba(239, 68, 68, 0.1);
      color: #dc2626;
    }
    
    .add-user-form {
      display: flex;
      gap: var(--spacing-md);
    }
    
    .add-user-form input {
      flex: 1;
      padding: var(--spacing-md);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      font-size: var(--font-size-base);
      background: var(--surface-elevated);
      color: var(--text-primary);
      transition: all var(--transition-fast);
      min-height: 44px;
    }
    
    .add-user-form input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }
    
    .add-user-form input::placeholder {
      color: var(--text-secondary);
    }
    
    .add-user-form button {
      padding: var(--spacing-md) var(--spacing-xl);
      background: var(--primary-color);
      color: var(--text-on-primary);
      border: none;
      border-radius: var(--radius-md);
      font-size: var(--font-size-base);
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition-fast);
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      min-height: 44px;
      white-space: nowrap;
    }
    
    .add-user-form button:hover {
      background: var(--primary-dark);
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }
    
    .back-link {
      text-align: center;
      margin-top: var(--spacing-xl);
      padding-top: var(--spacing-lg);
      border-top: 1px solid var(--border-color);
    }
    
    .back-link a {
      color: var(--text-secondary);
      text-decoration: none;
      font-size: var(--font-size-sm);
      display: inline-flex;
      align-items: center;
      gap: var(--spacing-sm);
      transition: color var(--transition-fast);
    }
    
    .back-link a:hover {
      color: var(--primary-color);
    }
    
    @media (max-width: 480px) {
      .user-selection-card {
        margin: var(--spacing-md);
        padding: var(--spacing-xl);
      }
      
      .user-selection-header h1 {
        font-size: var(--font-size-xl);
      }
      
      .add-user-form {
        flex-direction: column;
      }
      
      .add-user-form button {
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="user-selection-card">
    <div class="user-selection-header">
      <h1>
        <i class="fas fa-user-friends"></i>
        User Selection
      </h1>
      <p>Choose your profile to continue</p>
    </div>
    
    <div id="user-list" class="user-list"></div>
    
    <form id="add-user-form" class="add-user-form" autocomplete="off">
      <input id="new-user-name" placeholder="Enter new user name" required maxlength="20" />
      <button type="submit">
        <i class="fas fa-plus"></i>
        Add User
      </button>
    </form>
    
    <div class="back-link">
      <a href="index.html">
        <i class="fas fa-arrow-left"></i>
        Back to App
      </a>
    </div>
  </div>
  
  <script>
    function getUsers() {
      return JSON.parse(localStorage.getItem('userList') || '["GARY","TRISH"]');
    }
    function setUsers(users) {
      localStorage.setItem('userList', JSON.stringify(users));
    }
    function renderUsers() {
      const users = getUsers();
      const div = document.getElementById('user-list');
      div.innerHTML = '';
      users.forEach(user => {
        const item = document.createElement('div');
        item.className = "user-item";
        
        // Main button
        const btn = document.createElement('button');
        btn.className = "user-btn";
        btn.onclick = () => selectUser(user);
        btn.innerHTML = `
          <i class="fas fa-user-circle"></i>
          <span>${user}</span>
        `;
        
        // Delete button
        const del = document.createElement('button');
        del.className = "delete-btn";
        del.innerHTML = '<i class="fas fa-trash-alt"></i>';
        del.onclick = (e) => {
          e.stopPropagation();
          if (confirm(`Delete user "${user}" and all their data?`)) {
            deleteUser(user);
          }
        };
        
        item.appendChild(btn);
        item.appendChild(del);
        div.appendChild(item);
      });
    }
    function selectUser(user) {
      localStorage.setItem('currentUser', user);
      window.location.href = 'index.html?v=' + Date.now();
    }
    function deleteUser(user) {
      let users = getUsers().filter(u => u !== user);
      setUsers(users);
      localStorage.removeItem(user + '_medications');
      localStorage.removeItem(user + '_medLogs');
      renderUsers();
    }
    document.getElementById('add-user-form').onsubmit = function(e) {
      e.preventDefault();
      let users = getUsers();
      let name = document.getElementById('new-user-name').value.trim();
      if (name && !users.includes(name)) {
        users.push(name);
        setUsers(users);
        renderUsers();
        document.getElementById('new-user-name').value = '';
      } else {
        alert("User name must be unique and not empty.");
      }
    };
    renderUsers();
  </script>
</body>
</html>
